@model BookMyFlight.Backend.Models.EntityOrder

<div class="row justify-content-center mt-5">
    <div class="col-md-6">
        <div class="card p-4">
            <div class="card-body">
                <div class="text-center mb-4">
                    <h3 class="card-title">Confirm Your Payment</h3>
                    <p class="text-muted">Review your booking summary below</p>
                </div>

                <div class="bg-light p-3 rounded mb-4 border border-secondary border-opacity-10">
                    <div class="row mb-2">
                        <div class="col-5 fw-bold text-muted">Passenger Name:</div>
                        <div class="col-7 text-dark fw-bold">@Model.Name</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-5 fw-bold text-muted">Email ID:</div>
                        <div class="col-7">@Model.Email</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-5 fw-bold text-muted">Mobile Number:</div>
                        <div class="col-7">@Model.Mobile</div>
                    </div>
                    <hr />
                    <div class="row">
                        <div class="col-5 fw-bold text-primary fs-5">Total Amount:</div>
                        <div class="col-7 fw-bold fs-5 text-primary">₹@Model.Amount</div>
                    </div>
                </div>

                <div class="d-grid gap-2">
                    <button id="rzp-button1" class="btn btn-primary btn-lg shadow-sm">
                        <img src="https://razorpay.com/favicon.png" height="20" class="me-2" />
                        Pay with Razorpay
                    </button>
                    <a href="http://localhost:3000/payment" class="btn btn-outline-secondary">Go Back</a>
                </div>

                <form id="payment-form" method="post" action="/MyOrder/Payment">
                    <input type="hidden" name="razorpay_payment_id" id="razorpay_payment_id" />
                    <input type="hidden" name="razorpay_order_id" id="razorpay_order_id" />
                    <input type="hidden" name="razorpay_signature" id="razorpay_signature" />
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
    var options = {
        key: "@ViewBag.Key",
        amount: parseInt("@ViewBag.Amount"),
        currency: "INR",
        name: "Flight Booking",
        description: "Ticket Payment",
        order_id: "@ViewBag.OrderId",

        prefill: {
            name: "@Model.Name",
            email: "@Model.Email",
            contact: "@Model.Mobile"
        },

        handler: function (response) {
            document.getElementById("razorpay_payment_id").value = response.razorpay_payment_id;
            document.getElementById("razorpay_order_id").value = response.razorpay_order_id;
            document.getElementById("razorpay_signature").value = response.razorpay_signature;
            document.getElementById("payment-form").submit();
        }
    };

    var rzp1 = new Razorpay(options);

    document.getElementById("rzp-button1").onclick = function (e) {
        e.preventDefault();
        rzp1.open();
    };
</script>
